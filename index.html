<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator Siloz - 9 Celule</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f2f5;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .siloz-container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            width: 300px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .siloz-header {
            background-color: #2c3e50;
            color: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 15px;
        }
        .input-group {
            margin: 10px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #34495e;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 6px;
            font-size: 14px;
        }
        .progress-container {
            text-align: center;
            margin: 15px 0;
        }
        .cantitate-tone {
            font-size: 16px;
            font-weight: bold;
            color: #2c3e50;
            margin-top: 10px;
        }
        #chart-container {
            width: 80%;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container" id="silozuri-container"></div>
    <div id="chart-container">
        <canvas id="trendChart"></canvas>
    </div>
    <script>
        const CULORI_PRODUSE = {
            'grau': '#f1c40f',
            'porumb': '#e67e22',
            'rapita': '#3498db',
            'orz': '#ff69b4',
            'floarea-soarelui': '#95a5a6'
        };

        const trendSiloz = {};
        let trendChart;
        
        function genereazaSilozuri() {
            const container = document.getElementById("silozuri-container");
            for (let i = 1; i <= 9; i++) {
                trendSiloz[i] = [];
                const silozHTML = `
                    <div class="siloz-container">
                        <div class="siloz-header">
                            <h3>Siloz S${i}</h3>
                        </div>
                        <div class="input-group">
                            <label>Rază cilindru (m):</label>
                            <input type="number" id="razaCilindru${i}" value="11.17" onchange="calculeazaSiloz(${i})">
                        </div>
                        <div class="input-group">
                            <label>Înălțime cilindru (m):</label>
                            <input type="number" id="inaltimeCilindru${i}" value="16.40" onchange="calculeazaSiloz(${i})">
                        </div>
                        <div class="input-group">
                            <label>Tip Produs:</label>
                            <select id="tipProdus${i}" onchange="calculeazaSiloz(${i})">
                                <option value="grau">Grâu</option>
                                <option value="porumb">Porumb</option>
                                <option value="rapita">Rapiță</option>
                                <option value="orz">Orz</option>
                                <option value="floarea-soarelui">Floarea Soarelui</option>
                            </select>
                        </div>
                        <div class="progress-container">
                            <p id="cantitateTone${i}" class="cantitate-tone">Cantitate: 0 t</p>
                        </div>
                    </div>
                `;
                container.innerHTML += silozHTML;
            }
        }

        function calculeazaSiloz(index) {
            const razaCilindru = parseFloat(document.getElementById(`razaCilindru${index}`).value);
            const inaltimeCilindru = parseFloat(document.getElementById(`inaltimeCilindru${index}`).value);
            const tipProdus = document.getElementById(`tipProdus${index}`).value;
            
            const volumCilindru = Math.PI * Math.pow(razaCilindru, 2) * inaltimeCilindru;
            const tone = volumCilindru * 0.75;
            
            trendSiloz[index].push(tone);
            if (trendSiloz[index].length > 10) {
                trendSiloz[index].shift();
            }
            
            document.getElementById(`cantitateTone${index}`).textContent = `Cantitate: ${tone.toFixed(1)} t`;
            actualizeazaGrafic();
        }
        
        function actualizeazaGrafic() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            if (!trendChart) {
                trendChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 10}, (_, i) => `T-${10 - i}`),
                        datasets: Array.from({length: 9}, (_, i) => ({
                            label: `Siloz S${i + 1}`,
                            data: trendSiloz[i + 1],
                            borderColor: CULORI_PRODUSE['grau'],
                            fill: false
                        }))
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: { title: { display: true, text: 'Ultimele actualizări' } },
                            y: { title: { display: true, text: 'Cantitate (t)' }, beginAtZero: true }
                        }
                    }
                });
            } else {
                trendChart.data.datasets.forEach((dataset, i) => {
                    dataset.data = trendSiloz[i + 1];
                });
                trendChart.update();
            }
        }

        window.onload = () => {
            genereazaSilozuri();
        };
    </script>
</body>
</html>
